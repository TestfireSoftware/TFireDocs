<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basics · TFire</title><meta name="title" content="Basics · TFire"/><meta property="og:title" content="Basics · TFire"/><meta property="twitter:title" content="Basics · TFire"/><meta name="description" content="Documentation for TFire."/><meta property="og:description" content="Documentation for TFire."/><meta property="twitter:description" content="Documentation for TFire."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="TFire logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">TFire</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../collection.html">Collection</a></li><li><a class="tocitem" href="../layers.html">Layers</a></li><li><a class="tocitem" href="../specification.html">Specification</a></li><li><a class="tocitem" href="../data_views.html">DataViews</a></li><li><a class="tocitem" href="../returns.html">Returns</a></li><li><a class="tocitem" href="../sfdb.html">SimpleFastDB</a></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">External Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../external_data.html">External Data Handler</a></li><li><a class="tocitem" href="../external_data_disk.html">Data From Disk</a></li><li><a class="tocitem" href="../external_data_internet.html">Data From Internet</a></li><li><a class="tocitem" href="../external_data_sources.html">Internet Data Sources</a></li><li><a class="tocitem" href="../external_data_adding_source.html">Adding A New Data Source</a></li></ul></li><li><a class="tocitem" href="../back_testing.html">Backtesting</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href="tutorial_basics.html">Basics</a><ul class="internal"><li><a class="tocitem" href="#Collection-Setup"><span>Collection Setup</span></a></li><li><a class="tocitem" href="#Adding-Layers"><span>Adding Layers</span></a></li><li><a class="tocitem" href="#Plotting-the-Graph-for-a-Sample"><span>Plotting the Graph for a Sample</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="tutorial_backtest.html">Backtesting</a></li></ul></li><li><span class="tocitem">List of Functions</span><ul><li><a class="tocitem" href="../functions/functions_collection.html">Collection</a></li><li><a class="tocitem" href="../functions/functions_specification.html">Specification</a></li><li><a class="tocitem" href="../functions/functions_dataviews.html">DataViews</a></li><li><a class="tocitem" href="../functions/functions_returns.html">Returns</a></li><li><a class="tocitem" href="../functions/functions_sfdb.html">SimpleFastDB</a></li><li><a class="tocitem" href="../functions/functions_edh.html">External Data Handler</a></li><li><a class="tocitem" href="../functions/functions_backtest.html">Backtesting</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="tutorial_basics.html">Basics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial_basics.html">Basics</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-Basic-Analysis-of-Time-Series-Data"><a class="docs-heading-anchor" href="#Tutorial-Basic-Analysis-of-Time-Series-Data">Tutorial - Basic Analysis of Time Series Data</a><a id="Tutorial-Basic-Analysis-of-Time-Series-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-Basic-Analysis-of-Time-Series-Data" title="Permalink"></a></h1><p>The primary tool used to access and analyse time series is the <a href="../collection.html#Collection">Collection</a>. It contains a list of <a href="../collection.html#Assets">Assets</a>, where every Asset represents the time series of a single asset. An Asset typically contains several views into the time series, where each view is a continuous subset of the whole time series. Each such view is called a <code>sample</code>.</p><h2 id="Collection-Setup"><a class="docs-heading-anchor" href="#Collection-Setup">Collection Setup</a><a id="Collection-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Collection-Setup" title="Permalink"></a></h2><p>Below follows a simple example of how to setup a Collection.</p><pre><code class="nohighlight hljs">TFire&gt; tickers = [&quot;MMM&quot;, &quot;AOS&quot;]
2-element Vector{String}:
 &quot;MMM&quot;
 &quot;AOS&quot;

TFire&gt; eval_dates = dates_range(Date(2001,6,2), Date(2018,6,8))
6216-element Vector{Date}:
 2001-06-02...

TFire&gt; constituents = constituents_continuous(tickers, eval_dates, 600); 

TFire&gt; spec = SpecificationCollection(constituents);

TFire&gt; sfdb = setup_simple_fast_db(spec; read_disk=true, read_external=false, data_path = &quot;Days/spx500_1d.jld2&quot;);

TFire&gt; collection = setup_collection(spec, sfdb)
Setting up collection
||Collection|| (Continuous)
Tickers: 2, MMM AOS
Samples: 8562</code></pre><p>First the ticker symbols for the assets to be included are defined. Secondly the &quot;evaluation dates&quot; are specified as all dates between 6/2/2001 and 6/8/2018. An evaluation date is the last date in the series of dates &quot;seen&quot; by one sample. When a sample is later analyzed, no data beyond this date is visible to the analysis, preventing accidental &quot;look ahead&quot;. </p><p>The <code>Constituents</code> is just a summary of which tickers at what dates to be included. Here the 1800 is the number of days prior to the respective evaluation date sample has access to. A full <code>Specification</code> is then created from the Constituents. The Specification includes both the Constituents and the <code>DataFields</code>, specifying which types of data to be visible to the Collection. The DataFields are here implicitly set as defaults.</p><p>A <code>SimpleFastDB</code> database is set up with data from a file on disk. This is where all time series data lives.</p><p>Finally a <code>Collection</code> is then set up. The contents of the Collection is specified by the <code>Specification</code> and then theactual data is provided by a link to the <code>SimpleFastDB</code>.</p><h2 id="Adding-Layers"><a class="docs-heading-anchor" href="#Adding-Layers">Adding Layers</a><a id="Adding-Layers-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-Layers" title="Permalink"></a></h2><p>The Collection provides an interface to attach <a href="../layers.html#Layers">Layers</a> to a time series. A layer is a condensate of data associated with the time series. Layers may also be, as the name suggests, layered. For example, the first layer could be a pair of Exponential Moving Averages (EMAs) of the price of an asset and the second layer could then be the Moving Average Convergence Divergence (MACD) based on that pair of EMAs.</p><p>Example of adding layers:</p><pre><code class="nohighlight hljs">TFire&gt; settings = Settings()

TFire&gt; settings[LayerEMA] = Parameters(LayerEMA, :win_sizes =&gt; [12,26]);

TFire&gt; collection_ema = add_layer(collection, LayerEMA, settings=settings)
||Collection|| (Continuous) -&gt; LayerEMA
Tickers: 2, MMM AOS
Samples: 8514

TFire&gt; collection_macd = add_layer(collection_ema, LayerMACD)
||Collection|| (Continuous) -&gt; LayerEMA -&gt; LayerMACD
Tickers: 2, MMM AOS
Samples: 8514</code></pre><p>Here the concept of <a href="../collection.html#Collection-Settings">Collection Settings</a> is introduced. This is where parameters for Layers live. They may also contain other types of parameters, which we will soon see. It should be noted that <code>settings</code> was not needed when adding the MACD layer since it was already attached to <code>collection_ema</code> at its creation.</p><p>Let&#39;s have a look at all the settings that has been used</p><pre><code class="nohighlight hljs">TFire&gt; collection_macd.settings_used
LayerMACD
:signal_period =&gt; 9
:long_period =&gt; &quot;maximum&quot;
:short_period =&gt; &quot;minimum&quot;
   ---
TSDLink
:resolution =&gt; &quot;1d&quot;
:default_price_field =&gt; :adj_close_log
   ---
LayerEMA
:win_sizes =&gt; [12, 26]
   ---</code></pre><p>We can see that LayerMACD has settings even though no parameters were specified. This is because all Layers come with default parameters that are used if some parameter is omitted. The parameters for TSDLink specifies the resolution of the time series related to the Collection and which data field that is to be used when a layer requests the &quot;price&quot; of an asset. Here, the adjusted logarithmic closing price will then be used if nothing else is specified for a particular layer.</p><h2 id="Plotting-the-Graph-for-a-Sample"><a class="docs-heading-anchor" href="#Plotting-the-Graph-for-a-Sample">Plotting the Graph for a Sample</a><a id="Plotting-the-Graph-for-a-Sample-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Graph-for-a-Sample" title="Permalink"></a></h2><p>Let&#39;s look at the default graph for the first sample of the Asset with ticker MMM.</p><pre><code class="nohighlight hljs">TFire&gt; plot_graph(collection_macd, &quot;MMM&quot;, 1)</code></pre><p><img src="../assets/tutorial/tutorial_basics/macd_clear.png" alt="MACD Graph"/> Notice how the graph ends at 2 jun 2001 coinciding with the evaluation date of the first sample. No data beyond this date is visible to this particular sample.</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>Let&#39;s say we have a theory that any time the MACD histogram changes sign from negative to positive this signals a possible short term trend change. We can filter out all samples where the evaluation date has a positive value in the MACD histogram and the previous date is negative.</p><p>First we set up a function that returns true if a vector has a positive last value and a negative second to last value.</p><pre><code class="nohighlight hljs">TFire&gt; function macd_signal(macd_hist)
          return macd_hist[end-1] &lt; 0 &amp;&amp; macd_hist[end] &gt; 0
       end</code></pre><p>Secondly, we need to define a <code>DataView</code>. For now, all we need to know is that a Data View provides a view of some data in a Collection. Here a view of the MACD histogram from the MACD Layer. For a more comprehensive explanation of Data Views see <a href="../data_views.html#DataViews">DataViews</a>.</p><pre><code class="nohighlight hljs">TFire&gt; dv_macd = DVLayerField(collection_macd, :macd_histogram, LayerMACD);</code></pre><p>Now let&#39;s make a copy of the Collection.</p><pre><code class="nohighlight hljs">TFire&gt; collection_macd_copy = copy_collection(collection_macd)</code></pre><p>Now we can filter the Collection with the Data View and the predefined function. If the function returns true we want to keep the sample (thus action=:keep), otherwise throw it away.</p><pre><code class="nohighlight hljs">TFire&gt; filter_collection!(collection_macd_copy, dv_macd, macd_signal; action=:keep)</code></pre><p>Let&#39;s have a look at how many dates that were kept after the filtering.</p><pre><code class="nohighlight hljs">TFire&gt; collection_macd_copy
||Collection|| (Continuous) -&gt; LayerEMA -&gt; LayerMACD
Tickers: 2, MMM AOS
Samples: 346</code></pre><p>And how they are split between the two assets.</p><pre><code class="nohighlight hljs">TFire&gt; collection_macd_copy[&quot;MMM&quot;]
||Collection|| (Continuous) -&gt; LayerEMA -&gt; LayerMACD
Ticker: MMM
Samples: 171

TFire&gt; collection_macd_copy[&quot;AOS&quot;]
||Collection|| (Continuous) -&gt; LayerEMA -&gt; LayerMACD
Ticker: AOS
Samples: 175</code></pre><p>We can calculate the average returns for the resulting filtered collection <code>collection_macd_copy</code> and then we can plot an envelop of all possible best and worst returns of some subset with x number of samples of the whole of <code>collection_macd</code>.</p><pre><code class="nohighlight hljs">TFire&gt; plot_envelope(collection_macd_copy, collection_macd; steps=10)</code></pre><p><img src="../assets/tutorial/tutorial_basics/plot_envelope_10.png" alt="Envelope"/></p><p>The horizontal line marks the average return of collection_macd, and we can see that the filtered dates performed worse than the average date and significantly worse than the optimal choice of 353 dates/samples.</p><p>10 days might be a bad choice. Maybe some other period may prove to give a better result...</p><pre><code class="nohighlight hljs">TFire&gt; mean_return_filtered = mean_compound_return_total(collection_macd_copy, 150);
TFire&gt; mean_return_original = mean_compound_return_total(collection_macd, 150);
TFire&gt; diff_return = mean_return_filtered .- mean_return_original;
TFire&gt; plot(diff_return, label=&quot;Filtered - All&quot;, legend=:topright)</code></pre><p><img src="../assets/tutorial/tutorial_basics/diff_returns.png" alt="Diff Returns"/></p><p>Here, we calculated the difference between the average return of the filtered Collection and the average return of the original Collection for each possible step length. I.e element x in <code>diff_return</code> corresponds to the difference in average return after x steps.</p><p>We then plot this difference. From the plot we can see that the case for selecting dates to take a long position gets slightly better if we are looking to stay in the trade for a longer period but it never gets very convincing.</p><p>In <a href="tutorial_advanced.html#Tutorial-Advanced">Tutorial - Advanced</a> we look at a similar approach but with a larger amount of tickers and more advanced methods.</p><p>In <a href="tutorial_backtest.html#Tutorial-Backtesting">Tutorial - Backtesting</a> we instead look at how to do basic portfolio backtesting on a simple strategy.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../back_testing.html">« Backtesting</a><a class="docs-footer-nextpage" href="tutorial_backtest.html">Backtesting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 7 March 2024 13:02">Thursday 7 March 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
